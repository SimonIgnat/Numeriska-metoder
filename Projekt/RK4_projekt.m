function [t,y] = RK4(I0,T,n, C, L0)
    x1 = zeros(1,n+1); % phi
    x2 = zeros(1,n+1); % phi'

    x1(1) = I0(1);
    x2(1) = I0(2);

    h = T/n;

    for i= 1:n
        % dx1 = x2 x = [x1, x2], y = [1 0]x (I), x' = Ax A = [  ] 2x2
        % dx2 = (2*x2)/(1+x2^2)*x2^2
        
        [k0 l0] = rk_func(x1(i),x2(i),L0,C);
        [k1 l1] = rk_func(x1(i)+(1/2)*k0*h,x2(i)+(1/2)*l0*h,L0,C);
        [k2 l2] = rk_func(x1(i)+(1/2)*k1*h,x2(i)+(1/2)*l1*h,L0,C);
        [k3 l3] = rk_func(x1(i)+k2*h,x2(i)+l2*h,L0,C);
        %[k4 l4] = rk_func(x1(i)+(1/2)*k3,x2(i)+(1/2)*l3);
        x1(i+1) = x1(i)+h*(1/6)*(k0+2*k1+2*k2+k3);
        x2(i+1) = x2(i)+h*(1/6)*(l0+2*l1+2*l2+l3);
        
        
        
        
        %k0 = h*x2(i); k =
        %l0 = h*(2*x1(i)/(1+x1(i)^2)*x2(i)^2 - x1(i)*(1+x1(i)^2)/(L0*C));
        
        %k1 = h*(x2(i)+1/2*l0);
        %l1 = h*(2*(x1(i)+(1/2)*k0)/(1+(x1(i)+(1/2)*k0)^2)*(x2(i)+(1/2)*l0)^2 - (x1(i)+(1/2)*k0)*(1+(x1(i)+(1/2)*k0)^2)/(L0*C));
        
        %k2 = h*(x2(i) + (1/2)*l1);
        %l2 = h*(2*(x1(i)+(1/2)*k1)/(1+(x1(i)+(1/2)*k1)^2)*(x2(i)+(1/2)*l1)^2 - (x1(i)+(1/2)*k1)*(1+(x1(i)+(1/2)*k1)^2)/(L0*C));

        %k3 = h*(x2(i) + (1/2)*l2);
        %l3 = h*(2*(x1(i)+(1/2)*k2)/(1+(x1(i)+(1/2)*k2)^2)*(x2(i)+(1/2)*l2)^2 - (x1(i)+(1/2)*k2)*(1+(x1(i)+(1/2)*k2)^2)/(L0*C));
    
        %x1(i+1) = x1(i) + (1/6)*(k0+2*k1+2*k2+k3);
        %x2(i+1) = x2(i) + (1/6)*(l0+2*l1+2*l2+l3);
    end


    t = 0:h:T;
    y = [x1', x2'];


end

function  [k_next,l_next] = rk_func(x1,x2,L0,C)
    k_next = x2;
    l_next = ((2*x1)/(1+x1^2))*(x2^2)-(x1*(1+x1^2)/(L0*C));

    
end

